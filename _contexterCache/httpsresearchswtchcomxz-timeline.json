{"initialLink":"https://research.swtch.com/xz-timeline","sanitizedLink":"https://research.swtch.com/xz-timeline","finalLink":"https://research.swtch.com/xz-timeline","htmlEmbed":"<script>window.contexterSetup=window.contexterSetup||function(){window.contexterSetupComplete=!0;class ContexterLink extends HTMLAnchorElement{constructor(){super()}connectedCallback(){this.setAttribute(\"target\",\"_blank\")}}customElements.define(\"contexter-link\",ContexterLink,{extends:\"a\"}),customElements.define(\"contexter-inner\",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className=\"contexter-box__inner\"}}),customElements.define(\"contexter-thumbnail\",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className=\"contexter-box__thumbnail\"}}),customElements.define(\"contexter-byline\",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className=\"contexter-box__byline\"}}),customElements.define(\"contexter-keywordset\",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className=\"contexter-box__keywordset\"}}),customElements.define(\"contexter-linkset\",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className=\"contexter-box__linkset\"}}),customElements.define(\"contexter-meta\",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className=\"contexter-box__meta\"}}),customElements.define(\"contexter-summary\",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className=\"p-summary entry-summary\"}}),customElements.define(\"contexter-box-head\",class extends HTMLElement{constructor(){super()}connectedCallback(){this.className=\"contexter-box__head\"}}),customElements.define(\"contexter-box-inner\",class extends HTMLElement{constructor(){super()}connectedCallback(){}});class ContexterBox extends HTMLElement{constructor(){super(),this.first=!0,this.shadow=this.attachShadow({mode:\"open\"})}connectedCallback(){if(this.first){this.first=!1;var style=document.createElement(\"style\"),lightDomStyle=(style.innerHTML=`:host {--background: #f5f6f7;--border: darkblue;--blue: #0000ee;--font-color: black;--inner-border: black;font-family: Franklin,Arial,Helvetica,sans-serif;font-size: 14px;background: var(--background);width: 600px;color: var(--font-color);min-height: 90px;display: block;padding: 8px;border: 1px solid var(--border);cursor: pointer;box-sizing: border-box;margin: 6px;contain: content;margin: 6px auto;}// can only select top-level nodes with slotted::slotted(*) {max-width: 100%;display:block;}::slotted([slot=thumbnail]) {max-width: 100%;display:block;}::slotted([slot=header]) {width: 100%;font-size: 1.25rem;font-weight: bold;display:block;margin-bottom: 6px;}::slotted([slot=author]) {max-width: 50%;font-size: 12px;display:inline-block;float: left;}::slotted([slot=time]) {max-width: 50%;font-size: 12px;display:inline-block;float: right;}::slotted([slot=summary]) {width: 100%;margin-top: 6px;padding: 10px 2px;border-top: 1px solid var(--inner-border);font-size: 15px;display:inline-block;margin-bottom: 6px;}contexter-meta {height: auto;margin-bottom: 4px;width: 100%;display: grid;position: relative;min-height: 16px;grid-template-columns: repeat(2, 1fr);}::slotted([slot=keywords]) {width: 80%;padding: 2px 4px;border-top: 1px solid var(--inner-border);font-size: 11px;display: block;float: right;font-style: italic;text-align: right;grid-column: 2/2;grid-row: 1;align-self: end;justify-self: end;}::slotted([slot=keywords]):empty {border-top: 0px solid var(--inner-border);}::slotted([slot=archive-link]) {font-size: 1em;display: inline;}::slotted([slot=archive-link])::after {content: \"|\";display: inline;color: var(--font-color);text-decoration: none;margin: 0 .5em;}::slotted([slot=read-link]) {font-size: 1em;display: inline;}contexter-linkset {width: 80%;padding: 2px 4px;font-size: 13px;float: left;font-weight: bold;grid-row: 1;grid-column: 1/2;align-self: end;justify-self: start;}/* Extra small devices (phones, 600px and down) */@media only screen and (max-width: 600px) {:host {width: 310px;}}/* Small devices (portrait tablets and large phones, 600px and up) */@media only screen and (min-width: 600px) {...}/* Medium devices (landscape tablets, 768px and up) */@media only screen and (min-width: 768px) {...}/* Large devices (laptops/desktops, 992px and up) */@media only screen and (min-width: 992px) {...}/* Extra large devices (large laptops and desktops, 1200px and up) */@media only screen and (min-width: 1200px) {...}@media (prefers-color-scheme: dark){:host {--background: #354150;--border: #1f2b37;--blue: #55b0ff;--font-color: #ffffff;--inner-border: #787a7c;background: var(--background);border: 1px solid var(--border)}}`,document.createElement(\"style\"));lightDomStyle.innerHTML=`contexter-box {contain: content;}contexter-box .read-link {font-weight: bold;}contexter-box a {color: #0000ee;}contexter-box img {width: 100%;border: 0;padding: 0;margin: 0;}/* Extra small devices (phones, 600px and down) */@media only screen and (max-width: 600px) {...}/* Small devices (portrait tablets and large phones, 600px and up) */@media only screen and (min-width: 600px) {...}/* Medium devices (landscape tablets, 768px and up) */@media only screen and (min-width: 768px) {...}/* Large devices (laptops/desktops, 992px and up) */@media only screen and (min-width: 992px) {...}/* Extra large devices (large laptops and desktops, 1200px and up) */@media only screen and (min-width: 1200px) {...}@media (prefers-color-scheme: dark){contexter-box a {color: #55b0ff;}}`,this.appendChild(lightDomStyle),this.shadow.appendChild(style);const innerContainer=document.createElement(\"contexter-box-inner\"),innerSlotThumbnail=(this.shadow.appendChild(innerContainer),document.createElement(\"slot\")),innerSlotHeader=(innerSlotThumbnail.name=\"thumbnail\",innerContainer.appendChild(innerSlotThumbnail),document.createElement(\"slot\")),innerSlotAuthor=(innerSlotHeader.name=\"header\",innerContainer.appendChild(innerSlotHeader),document.createElement(\"slot\")),innerSlotTime=(innerSlotAuthor.name=\"author\",innerContainer.appendChild(innerSlotAuthor),document.createElement(\"slot\")),innerSlotSummary=(innerSlotTime.name=\"time\",innerContainer.appendChild(innerSlotTime),document.createElement(\"slot\")),metaContainer=(innerSlotSummary.name=\"summary\",innerContainer.appendChild(innerSlotSummary),document.createElement(\"contexter-meta\")),innerSlotInfo=(innerContainer.appendChild(metaContainer),document.createElement(\"slot\")),linkContainer=(innerSlotInfo.name=\"keywords\",metaContainer.appendChild(innerSlotInfo),document.createElement(\"contexter-linkset\")),innerSlotArchiveLink=(metaContainer.appendChild(linkContainer),document.createElement(\"slot\")),innerSlotReadLink=(innerSlotArchiveLink.name=\"archive-link\",linkContainer.appendChild(innerSlotArchiveLink),document.createElement(\"slot\"));innerSlotReadLink.name=\"read-link\",linkContainer.appendChild(innerSlotReadLink),this.className=\"contexter-box\",this.onclick=e=>{if(!e.target.className.includes(\"read-link\")&&!e.target.className.includes(\"title-link\")){const mainLinks=this.querySelectorAll(\"a.main-link\");mainLinks[0].click()}}}}}customElements.define(\"contexter-box\",ContexterBox)},window.contexterSetupComplete||window.contexterSetup();</script><contexter-box class=\"link-card h-entry hentry\" itemscope=\"\" itemtype=\"https://schema.org/CreativeWork\"><contexter-thumbnail class=\"thumbnail\" slot=\"thumbnail\"></contexter-thumbnail><contexter-box-head slot=\"header\" class=\"p-name entry-title\" itemprop=\"headline\"><contexter-box-head slot=\"header\" class=\"p-name entry-title\" itemprop=\"headline\"><a is=\"contexter-link\" href=\"https://research.swtch.com/xz-timeline\" itemprop=\"url\">research!rsc: Timeline of the xz open source attack</a></contexter-box-head></contexter-box-head><time class=\"dt-published published\" slot=\"time\" itemprop=\"datePublished\" datetime=\"2024-05-16T17:33:40.205Z\">5/16/2024</time><contexter-summary class=\"p-summary entry-summary\" itemprop=\"abstract\" slot=\"summary\"><p>Posted on Monday, April 1, 2024.Updated Wednesday, April 3, 2024.</p></contexter-summary><contexter-keywordset itemprop=\"keywords\" slot=\"keywords\"></contexter-keywordset><a href=\"https://web.archive.org/web/20240514231749/https://research.swtch.com/xz-timeline\" is=\"contexter-link\" target=\"_blank\" rel=\"timemap\" class=\"read-link archive-link\" itemprop=\"archivedAt\" slot=\"archive-link\">Archived</a><a is=\"contexter-link\" href=\"https://research.swtch.com/xz-timeline\" class=\"read-link main-link\" itemprop=\"sameAs\" slot=\"read-link\">Read</a></contexter-box>","linkId":"a7ea6ba440ece25e9ecaebfb87fb60e8aa915723","data":{"originalLink":"https://research.swtch.com/xz-timeline","sanitizedLink":"https://research.swtch.com/xz-timeline","canonical":"https://research.swtch.com/xz-timeline","htmlText":"<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"UTF-8\">\n    <title>research!rsc: Timeline of the xz open source attack</title>\n    <link rel=\"alternate\" type=\"application/atom+xml\" title=\"research!rsc - Atom\" href=\"http://research.swtch.com/feed.atom\" />\n    \n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n<link href=\"fonts/minion3/fonts.css\" rel=\"stylesheet\">\n<link href=\"fonts/source-code-pro/source-code-pro.css\" rel=\"stylesheet\">\n\n<style>\n  body {\n    padding: 0;\n    margin: 0;\n    font-size: 100%;\n    font-family: 'Minion 3', serif;\n  }\n  @media print {\n    img {page-break-inside: avoid;}\n    div.nosplit {page-break-inside: avoid;}\n  }\n  img.center {\n    display: block;\n    margin: 0 auto;\n  }\n  img.resizable {\n    max-width: 100%;\n    height: auto;\n  }\n  .pad {\n    padding-top: 1em;\n    padding-bottom: 1em;\n  }\n  a.anchor, a.back, a.footnote {\n    color: black !important;\n    text-decoration: none !important;\n  }\n  a.back {\n    font-size: 50%;\n  }\n  @media print {\n    a.back {display: none;}\n  }\n  .header {\n    height: 1.25em;\n    background-color: #dff;\n    margin: 0;\n    padding: 0.1em 0.1em 0.2em;\n    border-top: 1px solid black;\n    border-bottom: 1px solid #8ff;\n  }\n  .header h3 {\n    margin: 0;\n    padding: 0 2em;\n    display: inline-block;\n    padding-right: 2em;\n    font-style: italic;\n    font-size: 90%;\n  }\n  .rss {\n    float: right;\n    padding-top: 0.2em;\n    padding-right: 2em;\n    display: none;\n  }\n  .toc {\n    margin-top: 2em;\n  }\n  .toc-title {\n    font-family: cursive, serif;\n    font-style: italic;\n    font-size: 300%;\n    line-height: 83%;\n  }\n  .toc-subtitle {\n    display: block;\n    margin-bottom: 1em;\n    font-size: 83%;\n  }\n  @media only screen and (max-width: 550px) { .toc-subtitle { display: none; } }\n  .header h3 a {\n    color: black;\n  }\n  .header h4 {\n    margin: 0;\n    padding: 0;\n    display: inline-block;\n    font-weight: normal;\n    font-size: 83%;\n  }\n  @media only screen and (max-width: 550px) { .header h4 { display: none; } }\n  .main {\n    padding: 0 2em;\n  }\n  @media only screen and (max-width: 479px) { .article { font-size: 120%; } }\n  .article h1 {\n    text-align: center;\n    font-size: 200%;\n  }\n  .copyright {\n    font-size: 83%;\n  }\n  .subtitle {\n      font-size: 65%;\n  }\n  .normal {\n    font-size: medium;\n    font-weight: normal;\n  }\n  .when {\n    text-align: center;\n    font-size: 100%;\n    margin: 0;\n    padding: 0;\n  }\n  .when p {\n    margin: 0;\n    padding: 0;\n  }\n  .article h2 {\n    font-size: 125%;\n    padding-top: 0.25em;\n  }\n  .article h3 {\n    font-size: 100%;\n  }\n  pre {\n    margin-left: 4em;\n    margin-right: 4em;\n  }\n  pre, code {\n    font-family: 'Source Code Pro', monospace;\n    font-size: 90%;\n  }\n  .footer {\n    margin-top: 10px;\n    font-size: 83%;\n    font-family: sans-serif;\n  }\n  .comments {\n    margin-top: 2em;\n    background-color: #ffe;\n    border-top: 1px solid #aa4;\n    border-left: 1px solid #aa4;\n    border-right: 1px solid #aa4;\n  }\n  .comments-header {\n    padding: 0 5px 0 5px;\n  }\n  .comments-header p {\n    padding: 0;\n    margin: 3px 0 0 0;\n  }\n  .comments-body {\n    padding: 5px 5px 5px 5px;\n  }\n  #plus-comments {\n    border-bottom: 1px dotted #ccc;\n  }\n  .plus-comment {\n    width: 100%;\n    font-size: 14px;\n    border-top: 1px dotted #ccc;\n  }\n  .me {\n    background-color: #eec;\n  }\n  .plus-comment ul {\n    margin: 0;\n    padding: 0;\n    list-style: none;\n    width: 100%;\n    display: inline-block;\n  }\n  .comment-when {\n    color:#999;\n    width:auto;\n    padding:0 5px;\n  }\n  .old {\n    font-size: 83%;\n  }\n  .plus-comment ul li {\n    display: inline-block;\n    vertical-align: top;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    padding: 0;\n  }\n  .plus-icon {\n    width: 45px;\n  }\n  .plus-img {\n    float: left;\n    margin: 4px 4px 4px 4px;\n    width: 32px;\n    height: 32px;\n  }\n  .plus-comment p {\n    margin: 0;\n    padding: 0;\n  }\n  .plus-clear {\n    clear: left;\n  }\n  .toc-when {\n    font-size: 83%;\n    color: #999;\n  }\n  .toc {\n    list-style: none;\n  }\n  .toc li {\n    margin-bottom: 0.5em;\n  }\n  .toc-head {\n    margin-bottom: 1em !important;\n    font-size: 117%;\n  }\n  .toc-summary {\n    margin-left: 2em;\n  }\n  .favorite {\n    font-weight: bold;\n  }\n  .article p, .article ol {\n    line-height: 144%;\n  }\n  sup, sub {\n    vertical-align: baseline;\n    position: relative;\n    font-size: 83%;\n  }\n  sup {\n    bottom: 1ex;\n  }\n  sub {\n    top: 0.8ex;\n  }\n\n  .main {\n    position: relative;\n    margin: 0 auto;\n    padding: 0;\n    width: 900px;\n  }\n  @media only screen and (min-width: 768px) and (max-width: 959px) { .main { width: 708px; } }\n  @media only screen and (min-width: 640px) and (max-width: 767px) { .main { width: 580px; } }\n  @media only screen and (min-width: 480px) and (max-width: 639px) { .main { width: 420px; } }\n  @media only screen and (max-width: 479px) { .main { width: 300px; } }\n\n</style>\n\n  </head>\n  <body>\n    \n<div class=\"header\">\n  <h3><a href=\"/\">research!rsc</a></h3>\n  <h4>Thoughts and links about programming,\n    by <a href=\"https://swtch.com/~rsc/\" rel=\"author\">Russ Cox</a> </h4>\n  <a class=\"rss\" href=\"/feed.atom\">RSS</a>\n</div>\n\n    <div class=\"main\">\n      <div class=\"article\">\n        <h1>Timeline of the xz open source attack\n        \n        <div class=\"normal\">\n        <div class=\"when\">\n          \n            Posted on Monday, April 1, 2024.<br>Updated Wednesday, April 3, 2024.\n            \n          \n        </div>\n        </div>\n        </h1>\n        \n\n<p>\nOver a period of over two years, an attacker using the name “Jia Tan”\nworked as a diligent, effective contributor to the xz compression library,\neventually being granted commit access and maintainership.\nUsing that access, they installed a very subtle, carefully hidden backdoor into liblzma,\na part of xz that also happens to be a dependency of OpenSSH sshd\non Debian, Ubuntu, and Fedora, and other systemd-based Linux systems that patched sshd to link libsystemd.\n(Note that this does not include systems like Arch Linux, Gentoo, and NixOS, which do not patch sshd.)\nThat backdoor watches for the attacker sending hidden commands at the start of an SSH session,\ngiving the attacker the ability to run an arbitrary command on the target system without logging in:\nunauthenticated, targeted remote code execution.\n\n<p>\nThe attack was <a href=\"https://www.openwall.com/lists/oss-security/2024/03/29/4\">publicly disclosed on March 29, 2024</a> and\nappears to be the first serious known supply chain attack on widely used open source software.\nIt marks a watershed moment in open source supply chain security, for better or worse.\n\n<p>\nThis post is a detailed timeline that I have constructed of the\nsocial engineering aspect of the attack, which appears to date\nback to late 2021.\n(See also my <a href=\"xz-script\">analysis of the attack script</a>.)\n\n<p>\nCorrections or additions welcome on <a href=\"https://bsky.app/profile/swtch.com/post/3kp4my7wdom2q\">Bluesky</a>, <a href=\"https://hachyderm.io/@rsc/112199506755478946\">Mastodon</a>, or <a href=\"mailto:rsc@swtch.com\">email</a>.\n<a class=anchor href=\"#prologue\"><h2 id=\"prologue\">Prologue</h2></a>\n\n\n<p>\n<b>2005–2008</b>: <a href=\"https://github.com/kobolabs/liblzma/blob/87b7682ce4b1c849504e2b3641cebaad62aaef87/doc/history.txt\">Lasse Collin, with help from others</a>, designs the .xz file format using the LZMA compression algorithm, which compresses files to about 70% of what gzip did [1]. Over time this format becomes widely used for compressing tar files, Linux kernel images, and many other uses.\n<a class=anchor href=\"#jia_tan_arrives_on_scene_with_supporting_cast\"><h2 id=\"jia_tan_arrives_on_scene_with_supporting_cast\">Jia Tan arrives on scene, with supporting cast</h2></a>\n\n\n<p>\n<b>2021-10-29</b>: Jia Tan sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00512.html\">first, innocuous patch</a> to the xz-devel mailing list, adding “.editorconfig” file.\n\n<p>\n<b>2021-11-29</b>: Jia Tan sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00519.html\">second innocuous patch</a> to the xz-devel mailing list, fixing an apparent reproducible build problem. More patches that seem (even in retrospect) to be fine follow.\n\n<p>\n<b>2022-02-07</b>: Lasse Collin merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6468f7e41a8e9c611e4ba8d34e2175c5dacdbeb4\">first commit with “jiat0218@gmail.com” as author in git metadata</a> (“liblzma: Add NULL checks to LZMA and LZMA2 properties encoders”).\n\n<p>\n<b>2022-04-19</b>: Jia Tan sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00553.html\">yet another innocuous patch</a> to the xz-devel mailing list.\n\n<p>\n<b>2022-04-22</b>: “Jigar Kumar” sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00557.html\">first of a few emails</a> complaining about Jia Tan’s patch not landing. (“Patches spend years on this mailing list. There is no reason to think anything is coming soon.”) At this point, Lasse Collin has already landed four of Jia Tan’s patches, marked by “Thanks to Jia Tan” in the commit message.\n\n<p>\n<b>2022-05-19</b>: “Dennis Ens” sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00562.html\">mail to xz-devel</a> asking if XZ for Java is maintained.\n\n<p>\n<b>2022-05-19</b>: Lasse Collin <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00563.html\">replies</a> apologizing for slowness and adds “Jia Tan has helped me off-list with XZ Utils and he might have a bigger role in the future at least with XZ Utils. It's clear that my resources are too limited (thus the many emails waiting for replies) so something has to change in the long term.”\n\n<p>\n<b>2022-05-27</b>: Jigar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00565.html\">pressure email</a> to patch thread. “Over 1 month and no closer to being merged. Not a surprise.”\n\n<p>\n<b>2022-06-07</b>: Jigar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00566.html\">pressure email</a> to Java thread. “Progress will not happen until there is new maintainer. XZ for C has sparse commit log too. Dennis you are better off waiting until new maintainer happens or fork yourself. Submitting patches here has no purpose these days. The current maintainer lost interest or doesn't care to maintain anymore. It is sad to see for a repo like this.”\n\n<p>\n<b>2022-06-08</b>: Lasse Collin <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.html\">pushes back</a>. “I haven't lost interest but my ability to care has been fairly limited mostly due to longterm mental health issues but also due to some other things. Recently I've worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we'll see. It's also good to keep in mind that this is an unpaid hobby project.”\n\n<p>\n<b>2022-06-10</b>: Lasse Collin merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=aa75c5563a760aea3aa23d997d519e702e82726b\">first commit with “Jia Tan” as author in git metadata</a> (“Tests: Created tests for hardware functions”). Note also that there was one earlier commit on 2022-02-07 that had the full name set only to jiat75.\n\n<p>\n<b>2022-06-14</b>: Lasse Collin merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=0354d6cce3ff98ea6f927107baf216253f6ce2bb\">only commit with “jiat75@gmail.com” as author</a>. This could have been a temporary git misconfiguration on Jia Tan's side forgetting their fake email address.\n\n<p>\n<b>2022-06-14</b>: Jugar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00568.html\">pressure email</a>. “With your current rate, I very doubt to see 5.4.0 release this year. The only progress since april has been small changes to test code. You ignore the many  patches bit rotting away on this mailing list. Right now you choke your repo. Why wait until 5.4.0 to change maintainer? Why delay what your repo needs?”\n\n<p>\n<b>2022-06-21</b>: Dennis Ens sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00569.html\">pressure email</a>. “I am sorry about your mental health issues, but its important to be aware of your own limits. I get that this is a hobby project for all contributors, but the community desires more. Why not pass on maintainership for XZ for C so you can give XZ for Java more attention? Or pass on XZ for Java to someone else to focus on XZ for C? Trying to maintain both means that neither are maintained well.”\n\n<p>\n<b>2022-06-22</b>: Jigar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00570.html\">pressure email</a> to C patch thread. “Is there any progress on this? Jia I see you have recent commits. Why can't you commit this yourself?”\n\n<p>\n<b>2022-06-29</b>: Lasse Collin <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00571.html\">replies</a>: “As I have hinted in earlier emails, Jia Tan may have a bigger role in the project in the future. He has been helping a lot off-list and is practically a co-maintainer already. :-) I know that not much has happened in the git repository yet but things happen in small steps. In any case some change in maintainership is already in progress at least for XZ Utils.”\n<a class=anchor href=\"#jia_tan_becomes_maintainer\"><h2 id=\"jia_tan_becomes_maintainer\">Jia Tan becomes maintainer</h2></a>\n\n\n<p>\nAt this point Lasse seems to have started working even more closely with Jia Tan. Brian Krebs <a href=\"https://infosec.exchange/@briankrebs/112197305365490518\">observes</a> that many of these email addresses never appeared elsewhere on the internet, even in data breaches (nor again in xz-devel). It seems likely that they were fakes created to push Lasse to give Jia more control. It worked. Over the next few months, Jia started replying to threads on xz-devel authoritatively about the upcoming 5.4.0 release.\n\n<p>\n<b>2022-09-27</b>: Jia Tan gives <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00593.html\">release summary</a> for 5.4.0. (“The 5.4.0 release that will contain the multi threaded decoder is planned for December. The list of open issues related to 5..4.0 [sic] in general that I am tracking are...”)\n\n<p>\n<b>2022-10-28</b>: Jia Tan <a href=\"https://github.com/JiaT75?tab=overview&from=2022-10-01&to=2022-10-31\">added to the Tukaani organization</a> on GitHub. Being an organization member does not imply any special access, but it is a necessary step before granting maintainer access.\n\n<p>\n<b>2022-11-30</b>: Lasse Collin <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=764955e2d4f2a5e8d6d6fec63af694f799e050e7\">changes bug report email</a> from his personal address to an alias that goes to him and Jia Tan, notes in README that “the project maintainers Lasse Collin and Jia Tan can be reached via <a href=\"mailto:xz@tukaani.org\">xz@tukaani.org</a>”.\n\n<p>\n<b>2022-12-30</b>: Jia Tan merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=8ace358d65059152d9a1f43f4770170d29d35754\">a batch of commits directly into the xz repo</a> (“CMake: Update .gitignore for CMake artifacts from in source build”). At this point we know they have commit access. Interestingly, a <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=799ead162de63b8400733603d3abcd2e1977bdca\">few commits later</a> in the same batch is the only commit with a different full name: “Jia Cheong Tan”.\n\n<p>\n<b>2023-01-11</b>: Lasse Collin <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=18b845e69752c975dfeda418ec00eda22605c2ee\">tags and builds his final release</a>, v5.4.1.\n\n<p>\n<b>2023-03-18</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6ca8046ecbc7a1c81ee08f544bfd1414819fb2e8\">tags and builds their first release</a>, v5.4.2.\n\n<p>\n<b>2023-03-20</b>: Jia Tan <a href=\"https://github.com/google/oss-fuzz/commit/6403e93344476972e908ce17e8244f5c2b957dfd\">updates Google oss-fuzz configuration</a> to send bugs to them.\n\n<p>\n<b>2023-06-22</b>: Hans Jansen sends <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=23b5c36fb71904bfbe16bb20f976da38dadf6c3b\">a pair</a> of <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=b72d21202402a603db6d512fb9271cfa83249639\">patches</a>, merged by Lasse Collin, that use the “<a href=\"https://maskray.me/blog/2021-01-18-gnu-indirect-function\">GNU indirect function</a>” feature to select a fast CRC function at startup time. The final commit is <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=ee44863ae88e377a5df10db007ba9bfadde3d314\">reworked by Lasse Collin</a> and merged by Jia Tan. This change is important because it provides a hook by which the backdoor code can modify the global function tables before they are remapped read-only. While this change could be an innocent performance optimization by itself, Hans Jansen returns in 2024 to promote the backdoored xz and otherwise does not exist on the internet.\n\n<p>\n<b>2023-07-07</b>: Jia Tan <a href=\"https://github.com/google/oss-fuzz/commit/d2e42b2e489eac6fe6268e381b7db151f4c892c5\">disables ifunc support during oss-fuzz builds</a>, claiming ifunc is incompatible with address sanitizer. This may well be innocuous on its own, although it is also more groundwork for using ifunc later.\n\n<p>\n<b>2024-01-19</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=c26812c5b2c8a2a47f43214afe6b0b840c73e4f5\">moves web site to GitHub pages</a>, giving them control over the XZ Utils web page. Lasse Collin presumably created the DNS records for the xz.tukaani.org subdomain that points to GitHub pages. After the attack was discovered, Lasse Collin deleted this DNS record to move back to <a href=\"https://tukaani.org\">tukaani.org</a>, which he controls.\n<a class=anchor href=\"#attack_begins\"><h2 id=\"attack_begins\">Attack begins</h2></a>\n\n\n<p>\n<b>2024-02-23</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0\">merges hidden backdoor binary code</a> well hidden inside some binary test input files. The README already said (from long before Jia Tan showed up) “This directory contains bunch of files to test handling of .xz, .lzma (LZMA_Alone), and .lz (lzip) files in decoder implementations. Many of the files have been created by hand with a hex editor, thus there is no better \"source code\" than the files themselves.” Having these kinds of test files is very common for this kind of library. Jia Tan took advantage of this to add a few files that wouldn't be carefully reviewed.\n\n<p>\n<b>2024-02-24</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=2d7d862e3ffa8cec4fd3fdffcd84e984a17aa429\">tags and builds v5.6.0</a> and publishes an xz-5.6.0.tar.gz distribution with an extra, malicious build-to-host.m4 that adds the backdoor when building a deb/rpm package. This m4 file is not present in the source repository, but many other legitimate ones are added during package as well, so it’s not suspicious by itself. But the script has been modified from the usual copy to add the backdoor. See my <a href=\"xz-script\">xz attack shell script walkthrough post</a> for more.\n\n<p>\n<b>2024-02-24</b>: Gentoo <a href=\"https://bugs.gentoo.org/925415\">starts seeing crashes in 5.6.0</a>. This seems to be an actual ifunc bug, rather than a bug in the hidden backdoor, since this is the first xz with Hans Jansen’s ifunc changes, and Gentoo does not patch sshd to use libsystemd, so it doesn't have the backdoor.\n\n<p>\n<b>2024-02-26</b>: Debian <a href=\"https://tracker.debian.org/news/1506761/accepted-xz-utils-560-01-source-into-unstable/\">adds xz-utils 5.6.0-0.1</a> to unstable.\n\n<p>\n<b>2024-02-27</b>: Jia Tan starts emailing Richard W.M. Jones to update Fedora 40 (privately confirmed by Rich Jones).\n\n<p>\n<b>2024-02-28</b>: Debian <a href=\"https://tracker.debian.org/news/1507917/accepted-xz-utils-560-02-source-into-unstable/\">adds xz-utils 5.6.0-0.2</a> to unstable.\n\n<p>\n<b>2024-02-28</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=a100f9111c8cc7f5b5f0e4a5e8af3de7161c7975\">breaks landlock detection</a> in configure script by adding a subtle typo in the C program used to check for <a href=\"https://docs.kernel.org/userspace-api/landlock.html\">landlock support</a>. The configure script tries to build and run the C program to check for landlock support, but since the C program has a syntax error, it will never build and run, and the script will always decide there is no landlock support. Lasse Collin is listed as the committer; he may have missed the subtle typo, or the author may be forged. Probably the former, since Jia Tan did not bother to forge committer on his many other changes. This patch seems to be setting up for something besides the sshd change, since landlock support is part of the xz command and not liblzma. Exactly what is unclear.\n\n<p>\n<b>2024-02-29</b>: On GitHub, @teknoraver <a href=\"https://github.com/systemd/systemd/pull/31550\">sends pull request</a> to stop linking liblzma into libsystemd. It appears that this would have defeated the attack. <a href=\"https://doublepulsar.com/inside-the-failed-attempt-to-backdoor-ssh-globally-that-got-caught-by-chance-bbfe628fafdd\">Kevin Beaumont speculates</a> that knowing this was on the way may have accelerated the attacker’s schedule. @teknoraver <a href=\"https://news.ycombinator.com/item?id=39916125\">commented on HN</a> that the liblzma PR was one in a series of dependency slimming changes for libsystemd; there were <a href=\"https://github.com/systemd/systemd/pull/31131#issuecomment-1917693005\">two</a> <a href=\"https://github.com/systemd/systemd/pull/31131#issuecomment-1918667390\">mentions</a> of it in late January.\n\n<p>\n<b>2024-03-04</b>: RedHat distributions <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2267598\">start seeing Valgrind errors</a> in liblzma’s <code>_get_cpuid</code> (the entry to the backdoor). The race is on to fix this before the Linux distributions dig too deeply.\n\n<p>\n<b>2024-03-05</b>: The <a href=\"https://github.com/systemd/systemd/commit/3fc72d54132151c131301fc7954e0b44cdd3c860\">libsystemd PR is merged</a> to remove liblzma. Another race is on, to get liblzma backdoor'ed before the distros break the approach entirely.\n\n<p>\n<b>2024-03-05</b>: Debian <a href=\"https://tracker.debian.org/news/1509743/xz-utils-560-02-migrated-to-testing/\">adds xz-utils 5.6.0-0.2</a> to testing.\n\n<p>\n<b>2024-03-05</b>: Jia Tan commits <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=ed957d39426695e948b06de0ed952a2fbbe84bd1\">two ifunc</a> <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=4e1c97052b5f14f4d6dda99d12cbbd01e66e3712\">bug fixes</a>. These seem to be real fixes for the actual ifunc bug. One commit links to the Gentoo bug and also typos an <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=114115\">upstream GCC bug</a>.\n\n<p>\n<b>2024-03-08</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=82ecc538193b380a21622aea02b0ba078e7ade92\">commits purported Valgrind fix</a>. This is a misdirection, but an effective one.\n\n<p>\n<b>2024-03-09</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=74b138d2a6529f2c07729d7c77b1725a8e8b16f1\">commits updated backdoor files</a>. This is the actual Valgrind fix, changing the two test files containing the attack code. “The original files were generated with random local to my machine. To better reproduce these files in the future, a constant seed was used to recreate these files.”\n\n<p>\n<b>2024-03-09</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=fd1b975b7851e081ed6e5cf63df946cd5cbdbb94\">tags and build v5.6.1</a> and publishes xz 5.6.1 distribution, containing a new backdoor. To date I have not seen any analysis of how the old and new backdoors differ.\n\n<p>\n<b>2024-03-20</b>: Lasse Collin sends LKML a patch set <a href=\"https://lkml.org/lkml/2024/3/20/1009\">replacing his personal email</a> with <a href=\"https://lkml.org/lkml/2024/3/20/1008\">both himself and Jia Tan</a> as maintainers of the xz compression code in the kernel. There is no indication that Lasse Collin was acting nefariously here, just cleaning up references to himself as sole maintainer. Of course, Jia Tan may have prompted this, and being able to send xz patches to the Linux kernel would have been a nice point of leverage for Jia Tan's future work. We're not at <a href=\"nih\">trusting trust</a> levels yet, but it would be one step closer.\n\n<p>\n<b>2024-03-25</b>: Hans Jansen is back (!), <a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708\">filing a Debian bug</a> to get xz-utils updated to 5.6.1. Like in the 2022 pressure campaign, more name###@mailhost addresses that don’t otherwise exist on the internet show up to advocate for it.\n\n<p>\n<b>2024-03-27</b>: Debian updates to 5.6.1.\n\n<p>\n<b>2024-03-28</b>: Jia Tan <a href=\"https://bugs.launchpad.net/ubuntu/+source/xz-utils/+bug/2059417\">files an Ubuntu bug</a> to get xz-utils updated to 5.6.1 from Debian.\n<a class=anchor href=\"#attack_detected\"><h2 id=\"attack_detected\">Attack detected</h2></a>\n\n\n<p>\n<b>2024-03-28</b>: Andres Freund discovers bug, privately notifies Debian and distros@openwall. RedHat assigns CVE-2024-3094.\n\n<p>\n<b>2024-03-28</b>: Debian <a href=\"https://tracker.debian.org/news/1515519/accepted-xz-utils-561really545-1-source-into-unstable/\">rolls back 5.6.1</a>, introducing 5.6.1+really5.4.5-1.\n\n<p>\n<b>2024-03-28</b>: Arch Linux <a href=\"https://gitlab.archlinux.org/archlinux/packaging/packages/xz/-/commit/881385757abdc39d3cfea1c3e34ec09f637424ad\">changes 5.6.1 to build from Git</a>.\n\n<p>\n<b>2024-03-29</b>: Andres Freund <a href=\"https://www.openwall.com/lists/oss-security/2024/03/29/4\">posts backdoor warning</a> to public oss-security@openwall list, saying he found it “over the last weeks”.\n\n<p>\n<b>2024-03-29</b>: RedHat <a href=\"https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users\">announces that the backdoored xz shipped</a> in Fedora Rawhide and Fedora Linux 40 beta.\n\n<p>\n<b>2024-03-30</b>: Debian <a href=\"https://fulda.social/@Ganneff/112184975950858403\">shuts down builds</a> to rebuild their build machines using Debian stable (in case the malware xz escaped their sandbox?).\n\n<p>\n<b>2024-03-30</b>: Haiku OS <a href=\"https://github.com/haikuports/haikuports/commit/3644a3db2a0ad46971aa433c105e2cce9d141b46\">moves to GitHub source repo snapshots</a>.\n<a class=anchor href=\"#further_reading\"><h2 id=\"further_reading\">Further Reading</h2></a>\n<ul>\n<li>\nEvan Boehs, <a href=\"https://boehs.org/node/everything-i-know-about-the-xz-backdoor\">Everything I know about the XZ backdoor</a> (2024-03-29).\n<li>\nFilippo Valsorda, <a href=\"https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b\">Bluesky</a> re backdoor operation (2024-03-30).\n<li>\nMichał Zalewski, <a href=\"https://lcamtuf.substack.com/p/technologist-vs-spy-the-xz-backdoor\">Techies vs spies: the xz backdoor debate</a> (2024-03-30).\n<li>\nMichał Zalewski, <a href=\"https://lcamtuf.substack.com/p/oss-backdoors-the-allure-of-the-easy\">OSS backdoors: the folly of the easy fix</a> (2024-03-31).\n<li>\nConnor Tumbleson, <a href=\"https://connortumbleson.com/2024/03/31/watching-xz-unfold-from-afar/\">Watching xz unfold from afar</a> (2024-03-31).\n<li>\nnugxperience, <a href=\"https://twitter.com/nugxperience/status/1773906926503591970\">Twitter</a> re awk and rc4 (2024-03-29)\n<li>\nbirchb0y, <a href=\"https://twitter.com/birchb0y/status/1773871381890924872\">Twitter</a> re time of day of commit vs level of evil (2024-03-29)\n<li>\nDan Feidt, <a href=\"https://unicornriot.ninja/2024/xz-utils-software-backdoor-uncovered-in-years-long-hacking-plot/\">'xz utils' Software Backdoor Uncovered in Years-Long Hacking Plot</a> (2024-03-30)\n<li>\nsmx-smz, <a href=\"https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504\">[WIP] XZ Backdoor Analysis and symbol mapping</a>\n<li>\nDan Goodin, <a href=\"https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/\">What we know about the xz Utils backdoor that almost infected the world</a> (2024-04-01) <br>\n<li>\nAkamai Security Intelligence Group, <a href=\"https://www.akamai.com/blog/security-research/critical-linux-backdoor-xz-utils-discovered-what-to-know\">XZ Utils Backdoor — Everything You Need to Know, and What You Can Do</a> (2024-04-01)\n<li>\nKevin Beaumont, <a href=\"https://doublepulsar.com/inside-the-failed-attempt-to-backdoor-ssh-globally-that-got-caught-by-chance-bbfe628fafdd\">Inside the failed attempt to backdoor SSH globally — that got caught by chance</a> (2024-03-31)\n<li>\namlweems, <a href=\"https://github.com/amlweems/xzbot\">xzbot: notes, honeypot, and exploit demo for the xz backdoor</a> (2024-04-01)\n<li>\nRhea Karty and Simon Henniger, <a href=\"https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and\">XZ Backdoor: Times, damned times, and scams</a> (2024-03-30)\n<li>\nAndy Greenberg and Matt Burgess, <a href=\"https://www.wired.com/story/jia-tan-xz-backdoor/\">The Mystery of ‘Jia Tan,’ the XZ Backdoor Mastermind</a> (2024-04-03)\n<li>\n<a href=\"https://risky.biz/RB743/\">Risky Business #743 -- A chat about the xz backdoor with the guy who found it</a> (2024-04-03)</ul>\n\n      </div>\n    </div>\n  </body>\n</html>\n\n\n\n\n\n\n\n","oembed":false,"readabilityObject":{"title":"Timeline of the xz open source attack","content":"<div id=\"readability-page-1\" class=\"page\"><div>\n        <h2>Timeline of the xz open source attack\n        \n        <div>\n        <p>\n          \n            Posted on Monday, April 1, 2024.<br>Updated Wednesday, April 3, 2024.\n            \n          \n        </p>\n        </div>\n        </h2>\n        \n\n<p>\nOver a period of over two years, an attacker using the name “Jia Tan”\nworked as a diligent, effective contributor to the xz compression library,\neventually being granted commit access and maintainership.\nUsing that access, they installed a very subtle, carefully hidden backdoor into liblzma,\na part of xz that also happens to be a dependency of OpenSSH sshd\non Debian, Ubuntu, and Fedora, and other systemd-based Linux systems that patched sshd to link libsystemd.\n(Note that this does not include systems like Arch Linux, Gentoo, and NixOS, which do not patch sshd.)\nThat backdoor watches for the attacker sending hidden commands at the start of an SSH session,\ngiving the attacker the ability to run an arbitrary command on the target system without logging in:\nunauthenticated, targeted remote code execution.\n\n</p><p>\nThe attack was <a href=\"https://www.openwall.com/lists/oss-security/2024/03/29/4\">publicly disclosed on March 29, 2024</a> and\nappears to be the first serious known supply chain attack on widely used open source software.\nIt marks a watershed moment in open source supply chain security, for better or worse.\n\n</p><p>\nThis post is a detailed timeline that I have constructed of the\nsocial engineering aspect of the attack, which appears to date\nback to late 2021.\n(See also my <a href=\"xz-script\">analysis of the attack script</a>.)\n\n</p><p>\nCorrections or additions welcome on <a href=\"https://bsky.app/profile/swtch.com/post/3kp4my7wdom2q\">Bluesky</a>, <a href=\"https://hachyderm.io/@rsc/112199506755478946\">Mastodon</a>, or <a href=\"mailto:rsc@swtch.com\">email</a>.\n<a href=\"#prologue\"></a></p><h2 id=\"prologue\"><a href=\"#prologue\">Prologue</a></h2>\n\n\n<p>\n<b>2005–2008</b>: <a href=\"https://github.com/kobolabs/liblzma/blob/87b7682ce4b1c849504e2b3641cebaad62aaef87/doc/history.txt\">Lasse Collin, with help from others</a>, designs the .xz file format using the LZMA compression algorithm, which compresses files to about 70% of what gzip did [1]. Over time this format becomes widely used for compressing tar files, Linux kernel images, and many other uses.\n<a href=\"#jia_tan_arrives_on_scene_with_supporting_cast\"></a></p><h2 id=\"jia_tan_arrives_on_scene_with_supporting_cast\"><a href=\"#jia_tan_arrives_on_scene_with_supporting_cast\">Jia Tan arrives on scene, with supporting cast</a></h2>\n\n\n<p>\n<b>2021-10-29</b>: Jia Tan sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00512.html\">first, innocuous patch</a> to the xz-devel mailing list, adding “.editorconfig” file.\n\n</p><p>\n<b>2021-11-29</b>: Jia Tan sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00519.html\">second innocuous patch</a> to the xz-devel mailing list, fixing an apparent reproducible build problem. More patches that seem (even in retrospect) to be fine follow.\n\n</p><p>\n<b>2022-02-07</b>: Lasse Collin merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6468f7e41a8e9c611e4ba8d34e2175c5dacdbeb4\">first commit with “jiat0218@gmail.com” as author in git metadata</a> (“liblzma: Add NULL checks to LZMA and LZMA2 properties encoders”).\n\n</p><p>\n<b>2022-04-19</b>: Jia Tan sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00553.html\">yet another innocuous patch</a> to the xz-devel mailing list.\n\n</p><p>\n<b>2022-04-22</b>: “Jigar Kumar” sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00557.html\">first of a few emails</a> complaining about Jia Tan’s patch not landing. (“Patches spend years on this mailing list. There is no reason to think anything is coming soon.”) At this point, Lasse Collin has already landed four of Jia Tan’s patches, marked by “Thanks to Jia Tan” in the commit message.\n\n</p><p>\n<b>2022-05-19</b>: “Dennis Ens” sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00562.html\">mail to xz-devel</a> asking if XZ for Java is maintained.\n\n</p><p>\n<b>2022-05-19</b>: Lasse Collin <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00563.html\">replies</a> apologizing for slowness and adds “Jia Tan has helped me off-list with XZ Utils and he might have a bigger role in the future at least with XZ Utils. It's clear that my resources are too limited (thus the many emails waiting for replies) so something has to change in the long term.”\n\n</p><p>\n<b>2022-05-27</b>: Jigar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00565.html\">pressure email</a> to patch thread. “Over 1 month and no closer to being merged. Not a surprise.”\n\n</p><p>\n<b>2022-06-07</b>: Jigar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00566.html\">pressure email</a> to Java thread. “Progress will not happen until there is new maintainer. XZ for C has sparse commit log too. Dennis you are better off waiting until new maintainer happens or fork yourself. Submitting patches here has no purpose these days. The current maintainer lost interest or doesn't care to maintain anymore. It is sad to see for a repo like this.”\n\n</p><p>\n<b>2022-06-08</b>: Lasse Collin <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.html\">pushes back</a>. “I haven't lost interest but my ability to care has been fairly limited mostly due to longterm mental health issues but also due to some other things. Recently I've worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we'll see. It's also good to keep in mind that this is an unpaid hobby project.”\n\n</p><p>\n<b>2022-06-10</b>: Lasse Collin merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=aa75c5563a760aea3aa23d997d519e702e82726b\">first commit with “Jia Tan” as author in git metadata</a> (“Tests: Created tests for hardware functions”). Note also that there was one earlier commit on 2022-02-07 that had the full name set only to jiat75.\n\n</p><p>\n<b>2022-06-14</b>: Lasse Collin merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=0354d6cce3ff98ea6f927107baf216253f6ce2bb\">only commit with “jiat75@gmail.com” as author</a>. This could have been a temporary git misconfiguration on Jia Tan's side forgetting their fake email address.\n\n</p><p>\n<b>2022-06-14</b>: Jugar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00568.html\">pressure email</a>. “With your current rate, I very doubt to see 5.4.0 release this year. The only progress since april has been small changes to test code. You ignore the many  patches bit rotting away on this mailing list. Right now you choke your repo. Why wait until 5.4.0 to change maintainer? Why delay what your repo needs?”\n\n</p><p>\n<b>2022-06-21</b>: Dennis Ens sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00569.html\">pressure email</a>. “I am sorry about your mental health issues, but its important to be aware of your own limits. I get that this is a hobby project for all contributors, but the community desires more. Why not pass on maintainership for XZ for C so you can give XZ for Java more attention? Or pass on XZ for Java to someone else to focus on XZ for C? Trying to maintain both means that neither are maintained well.”\n\n</p><p>\n<b>2022-06-22</b>: Jigar Kumar sends <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00570.html\">pressure email</a> to C patch thread. “Is there any progress on this? Jia I see you have recent commits. Why can't you commit this yourself?”\n\n</p><p>\n<b>2022-06-29</b>: Lasse Collin <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00571.html\">replies</a>: “As I have hinted in earlier emails, Jia Tan may have a bigger role in the project in the future. He has been helping a lot off-list and is practically a co-maintainer already. :-) I know that not much has happened in the git repository yet but things happen in small steps. In any case some change in maintainership is already in progress at least for XZ Utils.”\n<a href=\"#jia_tan_becomes_maintainer\"></a></p><h2 id=\"jia_tan_becomes_maintainer\"><a href=\"#jia_tan_becomes_maintainer\">Jia Tan becomes maintainer</a></h2>\n\n\n<p>\nAt this point Lasse seems to have started working even more closely with Jia Tan. Brian Krebs <a href=\"https://infosec.exchange/@briankrebs/112197305365490518\">observes</a> that many of these email addresses never appeared elsewhere on the internet, even in data breaches (nor again in xz-devel). It seems likely that they were fakes created to push Lasse to give Jia more control. It worked. Over the next few months, Jia started replying to threads on xz-devel authoritatively about the upcoming 5.4.0 release.\n\n</p><p>\n<b>2022-09-27</b>: Jia Tan gives <a href=\"https://www.mail-archive.com/xz-devel@tukaani.org/msg00593.html\">release summary</a> for 5.4.0. (“The 5.4.0 release that will contain the multi threaded decoder is planned for December. The list of open issues related to 5..4.0 [sic] in general that I am tracking are...”)\n\n</p><p>\n<b>2022-10-28</b>: Jia Tan <a href=\"https://github.com/JiaT75?tab=overview&amp;from=2022-10-01&amp;to=2022-10-31\">added to the Tukaani organization</a> on GitHub. Being an organization member does not imply any special access, but it is a necessary step before granting maintainer access.\n\n</p><p>\n<b>2022-11-30</b>: Lasse Collin <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=764955e2d4f2a5e8d6d6fec63af694f799e050e7\">changes bug report email</a> from his personal address to an alias that goes to him and Jia Tan, notes in README that “the project maintainers Lasse Collin and Jia Tan can be reached via <a href=\"mailto:xz@tukaani.org\">xz@tukaani.org</a>”.\n\n</p><p>\n<b>2022-12-30</b>: Jia Tan merges <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=8ace358d65059152d9a1f43f4770170d29d35754\">a batch of commits directly into the xz repo</a> (“CMake: Update .gitignore for CMake artifacts from in source build”). At this point we know they have commit access. Interestingly, a <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=799ead162de63b8400733603d3abcd2e1977bdca\">few commits later</a> in the same batch is the only commit with a different full name: “Jia Cheong Tan”.\n\n</p><p>\n<b>2023-01-11</b>: Lasse Collin <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=18b845e69752c975dfeda418ec00eda22605c2ee\">tags and builds his final release</a>, v5.4.1.\n\n</p><p>\n<b>2023-03-18</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6ca8046ecbc7a1c81ee08f544bfd1414819fb2e8\">tags and builds their first release</a>, v5.4.2.\n\n</p><p>\n<b>2023-03-20</b>: Jia Tan <a href=\"https://github.com/google/oss-fuzz/commit/6403e93344476972e908ce17e8244f5c2b957dfd\">updates Google oss-fuzz configuration</a> to send bugs to them.\n\n</p><p>\n<b>2023-06-22</b>: Hans Jansen sends <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=23b5c36fb71904bfbe16bb20f976da38dadf6c3b\">a pair</a> of <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=b72d21202402a603db6d512fb9271cfa83249639\">patches</a>, merged by Lasse Collin, that use the “<a href=\"https://maskray.me/blog/2021-01-18-gnu-indirect-function\">GNU indirect function</a>” feature to select a fast CRC function at startup time. The final commit is <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=ee44863ae88e377a5df10db007ba9bfadde3d314\">reworked by Lasse Collin</a> and merged by Jia Tan. This change is important because it provides a hook by which the backdoor code can modify the global function tables before they are remapped read-only. While this change could be an innocent performance optimization by itself, Hans Jansen returns in 2024 to promote the backdoored xz and otherwise does not exist on the internet.\n\n</p><p>\n<b>2023-07-07</b>: Jia Tan <a href=\"https://github.com/google/oss-fuzz/commit/d2e42b2e489eac6fe6268e381b7db151f4c892c5\">disables ifunc support during oss-fuzz builds</a>, claiming ifunc is incompatible with address sanitizer. This may well be innocuous on its own, although it is also more groundwork for using ifunc later.\n\n</p><p>\n<b>2024-01-19</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=c26812c5b2c8a2a47f43214afe6b0b840c73e4f5\">moves web site to GitHub pages</a>, giving them control over the XZ Utils web page. Lasse Collin presumably created the DNS records for the xz.tukaani.org subdomain that points to GitHub pages. After the attack was discovered, Lasse Collin deleted this DNS record to move back to <a href=\"https://tukaani.org/\">tukaani.org</a>, which he controls.\n<a href=\"#attack_begins\"></a></p><h2 id=\"attack_begins\"><a href=\"#attack_begins\">Attack begins</a></h2>\n\n\n<p>\n<b>2024-02-23</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0\">merges hidden backdoor binary code</a> well hidden inside some binary test input files. The README already said (from long before Jia Tan showed up) “This directory contains bunch of files to test handling of .xz, .lzma (LZMA_Alone), and .lz (lzip) files in decoder implementations. Many of the files have been created by hand with a hex editor, thus there is no better \"source code\" than the files themselves.” Having these kinds of test files is very common for this kind of library. Jia Tan took advantage of this to add a few files that wouldn't be carefully reviewed.\n\n</p><p>\n<b>2024-02-24</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=2d7d862e3ffa8cec4fd3fdffcd84e984a17aa429\">tags and builds v5.6.0</a> and publishes an xz-5.6.0.tar.gz distribution with an extra, malicious build-to-host.m4 that adds the backdoor when building a deb/rpm package. This m4 file is not present in the source repository, but many other legitimate ones are added during package as well, so it’s not suspicious by itself. But the script has been modified from the usual copy to add the backdoor. See my <a href=\"xz-script\">xz attack shell script walkthrough post</a> for more.\n\n</p><p>\n<b>2024-02-24</b>: Gentoo <a href=\"https://bugs.gentoo.org/925415\">starts seeing crashes in 5.6.0</a>. This seems to be an actual ifunc bug, rather than a bug in the hidden backdoor, since this is the first xz with Hans Jansen’s ifunc changes, and Gentoo does not patch sshd to use libsystemd, so it doesn't have the backdoor.\n\n</p><p>\n<b>2024-02-26</b>: Debian <a href=\"https://tracker.debian.org/news/1506761/accepted-xz-utils-560-01-source-into-unstable/\">adds xz-utils 5.6.0-0.1</a> to unstable.\n\n</p><p>\n<b>2024-02-27</b>: Jia Tan starts emailing Richard W.M. Jones to update Fedora 40 (privately confirmed by Rich Jones).\n\n</p><p>\n<b>2024-02-28</b>: Debian <a href=\"https://tracker.debian.org/news/1507917/accepted-xz-utils-560-02-source-into-unstable/\">adds xz-utils 5.6.0-0.2</a> to unstable.\n\n</p><p>\n<b>2024-02-28</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=a100f9111c8cc7f5b5f0e4a5e8af3de7161c7975\">breaks landlock detection</a> in configure script by adding a subtle typo in the C program used to check for <a href=\"https://docs.kernel.org/userspace-api/landlock.html\">landlock support</a>. The configure script tries to build and run the C program to check for landlock support, but since the C program has a syntax error, it will never build and run, and the script will always decide there is no landlock support. Lasse Collin is listed as the committer; he may have missed the subtle typo, or the author may be forged. Probably the former, since Jia Tan did not bother to forge committer on his many other changes. This patch seems to be setting up for something besides the sshd change, since landlock support is part of the xz command and not liblzma. Exactly what is unclear.\n\n</p><p>\n<b>2024-02-29</b>: On GitHub, @teknoraver <a href=\"https://github.com/systemd/systemd/pull/31550\">sends pull request</a> to stop linking liblzma into libsystemd. It appears that this would have defeated the attack. <a href=\"https://doublepulsar.com/inside-the-failed-attempt-to-backdoor-ssh-globally-that-got-caught-by-chance-bbfe628fafdd\">Kevin Beaumont speculates</a> that knowing this was on the way may have accelerated the attacker’s schedule. @teknoraver <a href=\"https://news.ycombinator.com/item?id=39916125\">commented on HN</a> that the liblzma PR was one in a series of dependency slimming changes for libsystemd; there were <a href=\"https://github.com/systemd/systemd/pull/31131#issuecomment-1917693005\">two</a> <a href=\"https://github.com/systemd/systemd/pull/31131#issuecomment-1918667390\">mentions</a> of it in late January.\n\n</p><p>\n<b>2024-03-04</b>: RedHat distributions <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2267598\">start seeing Valgrind errors</a> in liblzma’s <code>_get_cpuid</code> (the entry to the backdoor). The race is on to fix this before the Linux distributions dig too deeply.\n\n</p><p>\n<b>2024-03-05</b>: The <a href=\"https://github.com/systemd/systemd/commit/3fc72d54132151c131301fc7954e0b44cdd3c860\">libsystemd PR is merged</a> to remove liblzma. Another race is on, to get liblzma backdoor'ed before the distros break the approach entirely.\n\n</p><p>\n<b>2024-03-05</b>: Debian <a href=\"https://tracker.debian.org/news/1509743/xz-utils-560-02-migrated-to-testing/\">adds xz-utils 5.6.0-0.2</a> to testing.\n\n</p><p>\n<b>2024-03-05</b>: Jia Tan commits <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=ed957d39426695e948b06de0ed952a2fbbe84bd1\">two ifunc</a> <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=4e1c97052b5f14f4d6dda99d12cbbd01e66e3712\">bug fixes</a>. These seem to be real fixes for the actual ifunc bug. One commit links to the Gentoo bug and also typos an <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=114115\">upstream GCC bug</a>.\n\n</p><p>\n<b>2024-03-08</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=82ecc538193b380a21622aea02b0ba078e7ade92\">commits purported Valgrind fix</a>. This is a misdirection, but an effective one.\n\n</p><p>\n<b>2024-03-09</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=74b138d2a6529f2c07729d7c77b1725a8e8b16f1\">commits updated backdoor files</a>. This is the actual Valgrind fix, changing the two test files containing the attack code. “The original files were generated with random local to my machine. To better reproduce these files in the future, a constant seed was used to recreate these files.”\n\n</p><p>\n<b>2024-03-09</b>: Jia Tan <a href=\"https://git.tukaani.org/?p=xz.git;a=commitdiff;h=fd1b975b7851e081ed6e5cf63df946cd5cbdbb94\">tags and build v5.6.1</a> and publishes xz 5.6.1 distribution, containing a new backdoor. To date I have not seen any analysis of how the old and new backdoors differ.\n\n</p><p>\n<b>2024-03-20</b>: Lasse Collin sends LKML a patch set <a href=\"https://lkml.org/lkml/2024/3/20/1009\">replacing his personal email</a> with <a href=\"https://lkml.org/lkml/2024/3/20/1008\">both himself and Jia Tan</a> as maintainers of the xz compression code in the kernel. There is no indication that Lasse Collin was acting nefariously here, just cleaning up references to himself as sole maintainer. Of course, Jia Tan may have prompted this, and being able to send xz patches to the Linux kernel would have been a nice point of leverage for Jia Tan's future work. We're not at <a href=\"nih\">trusting trust</a> levels yet, but it would be one step closer.\n\n</p><p>\n<b>2024-03-25</b>: Hans Jansen is back (!), <a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708\">filing a Debian bug</a> to get xz-utils updated to 5.6.1. Like in the 2022 pressure campaign, more name###@mailhost addresses that don’t otherwise exist on the internet show up to advocate for it.\n\n</p><p>\n<b>2024-03-27</b>: Debian updates to 5.6.1.\n\n</p><p>\n<b>2024-03-28</b>: Jia Tan <a href=\"https://bugs.launchpad.net/ubuntu/+source/xz-utils/+bug/2059417\">files an Ubuntu bug</a> to get xz-utils updated to 5.6.1 from Debian.\n<a href=\"#attack_detected\"></a></p><h2 id=\"attack_detected\"><a href=\"#attack_detected\">Attack detected</a></h2>\n\n\n<p>\n<b>2024-03-28</b>: Andres Freund discovers bug, privately notifies Debian and distros@openwall. RedHat assigns CVE-2024-3094.\n\n</p><p>\n<b>2024-03-28</b>: Debian <a href=\"https://tracker.debian.org/news/1515519/accepted-xz-utils-561really545-1-source-into-unstable/\">rolls back 5.6.1</a>, introducing 5.6.1+really5.4.5-1.\n\n</p><p>\n<b>2024-03-28</b>: Arch Linux <a href=\"https://gitlab.archlinux.org/archlinux/packaging/packages/xz/-/commit/881385757abdc39d3cfea1c3e34ec09f637424ad\">changes 5.6.1 to build from Git</a>.\n\n</p><p>\n<b>2024-03-29</b>: Andres Freund <a href=\"https://www.openwall.com/lists/oss-security/2024/03/29/4\">posts backdoor warning</a> to public oss-security@openwall list, saying he found it “over the last weeks”.\n\n</p><p>\n<b>2024-03-29</b>: RedHat <a href=\"https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users\">announces that the backdoored xz shipped</a> in Fedora Rawhide and Fedora Linux 40 beta.\n\n</p><p>\n<b>2024-03-30</b>: Debian <a href=\"https://fulda.social/@Ganneff/112184975950858403\">shuts down builds</a> to rebuild their build machines using Debian stable (in case the malware xz escaped their sandbox?).\n\n</p><p>\n<b>2024-03-30</b>: Haiku OS <a href=\"https://github.com/haikuports/haikuports/commit/3644a3db2a0ad46971aa433c105e2cce9d141b46\">moves to GitHub source repo snapshots</a>.\n<a href=\"#further_reading\"></a></p><h2 id=\"further_reading\"><a href=\"#further_reading\">Further Reading</a></h2>\n<ul>\n<li>\nEvan Boehs, <a href=\"https://boehs.org/node/everything-i-know-about-the-xz-backdoor\">Everything I know about the XZ backdoor</a> (2024-03-29).\n</li><li>\nFilippo Valsorda, <a href=\"https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b\">Bluesky</a> re backdoor operation (2024-03-30).\n</li><li>\nMichał Zalewski, <a href=\"https://lcamtuf.substack.com/p/technologist-vs-spy-the-xz-backdoor\">Techies vs spies: the xz backdoor debate</a> (2024-03-30).\n</li><li>\nMichał Zalewski, <a href=\"https://lcamtuf.substack.com/p/oss-backdoors-the-allure-of-the-easy\">OSS backdoors: the folly of the easy fix</a> (2024-03-31).\n</li><li>\nConnor Tumbleson, <a href=\"https://connortumbleson.com/2024/03/31/watching-xz-unfold-from-afar/\">Watching xz unfold from afar</a> (2024-03-31).\n</li><li>\nnugxperience, <a href=\"https://twitter.com/nugxperience/status/1773906926503591970\">Twitter</a> re awk and rc4 (2024-03-29)\n</li><li>\nbirchb0y, <a href=\"https://twitter.com/birchb0y/status/1773871381890924872\">Twitter</a> re time of day of commit vs level of evil (2024-03-29)\n</li><li>\nDan Feidt, <a href=\"https://unicornriot.ninja/2024/xz-utils-software-backdoor-uncovered-in-years-long-hacking-plot/\">'xz utils' Software Backdoor Uncovered in Years-Long Hacking Plot</a> (2024-03-30)\n</li><li>\nsmx-smz, <a href=\"https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504\">[WIP] XZ Backdoor Analysis and symbol mapping</a>\n</li><li>\nDan Goodin, <a href=\"https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/\">What we know about the xz Utils backdoor that almost infected the world</a> (2024-04-01) <br>\n</li><li>\nAkamai Security Intelligence Group, <a href=\"https://www.akamai.com/blog/security-research/critical-linux-backdoor-xz-utils-discovered-what-to-know\">XZ Utils Backdoor — Everything You Need to Know, and What You Can Do</a> (2024-04-01)\n</li><li>\nKevin Beaumont, <a href=\"https://doublepulsar.com/inside-the-failed-attempt-to-backdoor-ssh-globally-that-got-caught-by-chance-bbfe628fafdd\">Inside the failed attempt to backdoor SSH globally — that got caught by chance</a> (2024-03-31)\n</li><li>\namlweems, <a href=\"https://github.com/amlweems/xzbot\">xzbot: notes, honeypot, and exploit demo for the xz backdoor</a> (2024-04-01)\n</li><li>\nRhea Karty and Simon Henniger, <a href=\"https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and\">XZ Backdoor: Times, damned times, and scams</a> (2024-03-30)\n</li><li>\nAndy Greenberg and Matt Burgess, <a href=\"https://www.wired.com/story/jia-tan-xz-backdoor/\">The Mystery of ‘Jia Tan,’ the XZ Backdoor Mastermind</a> (2024-04-03)\n</li><li>\n<a href=\"https://risky.biz/RB743/\">Risky Business #743 -- A chat about the xz backdoor with the guy who found it</a> (2024-04-03)</li></ul>\n\n      </div></div>","textContent":"\n        Timeline of the xz open source attack\n        \n        \n        \n          \n            Posted on Monday, April 1, 2024.Updated Wednesday, April 3, 2024.\n            \n          \n        \n        \n        \n        \n\n\nOver a period of over two years, an attacker using the name “Jia Tan”\nworked as a diligent, effective contributor to the xz compression library,\neventually being granted commit access and maintainership.\nUsing that access, they installed a very subtle, carefully hidden backdoor into liblzma,\na part of xz that also happens to be a dependency of OpenSSH sshd\non Debian, Ubuntu, and Fedora, and other systemd-based Linux systems that patched sshd to link libsystemd.\n(Note that this does not include systems like Arch Linux, Gentoo, and NixOS, which do not patch sshd.)\nThat backdoor watches for the attacker sending hidden commands at the start of an SSH session,\ngiving the attacker the ability to run an arbitrary command on the target system without logging in:\nunauthenticated, targeted remote code execution.\n\n\nThe attack was publicly disclosed on March 29, 2024 and\nappears to be the first serious known supply chain attack on widely used open source software.\nIt marks a watershed moment in open source supply chain security, for better or worse.\n\n\nThis post is a detailed timeline that I have constructed of the\nsocial engineering aspect of the attack, which appears to date\nback to late 2021.\n(See also my analysis of the attack script.)\n\n\nCorrections or additions welcome on Bluesky, Mastodon, or email.\nPrologue\n\n\n\n2005–2008: Lasse Collin, with help from others, designs the .xz file format using the LZMA compression algorithm, which compresses files to about 70% of what gzip did [1]. Over time this format becomes widely used for compressing tar files, Linux kernel images, and many other uses.\nJia Tan arrives on scene, with supporting cast\n\n\n\n2021-10-29: Jia Tan sends first, innocuous patch to the xz-devel mailing list, adding “.editorconfig” file.\n\n\n2021-11-29: Jia Tan sends second innocuous patch to the xz-devel mailing list, fixing an apparent reproducible build problem. More patches that seem (even in retrospect) to be fine follow.\n\n\n2022-02-07: Lasse Collin merges first commit with “jiat0218@gmail.com” as author in git metadata (“liblzma: Add NULL checks to LZMA and LZMA2 properties encoders”).\n\n\n2022-04-19: Jia Tan sends yet another innocuous patch to the xz-devel mailing list.\n\n\n2022-04-22: “Jigar Kumar” sends first of a few emails complaining about Jia Tan’s patch not landing. (“Patches spend years on this mailing list. There is no reason to think anything is coming soon.”) At this point, Lasse Collin has already landed four of Jia Tan’s patches, marked by “Thanks to Jia Tan” in the commit message.\n\n\n2022-05-19: “Dennis Ens” sends mail to xz-devel asking if XZ for Java is maintained.\n\n\n2022-05-19: Lasse Collin replies apologizing for slowness and adds “Jia Tan has helped me off-list with XZ Utils and he might have a bigger role in the future at least with XZ Utils. It's clear that my resources are too limited (thus the many emails waiting for replies) so something has to change in the long term.”\n\n\n2022-05-27: Jigar Kumar sends pressure email to patch thread. “Over 1 month and no closer to being merged. Not a surprise.”\n\n\n2022-06-07: Jigar Kumar sends pressure email to Java thread. “Progress will not happen until there is new maintainer. XZ for C has sparse commit log too. Dennis you are better off waiting until new maintainer happens or fork yourself. Submitting patches here has no purpose these days. The current maintainer lost interest or doesn't care to maintain anymore. It is sad to see for a repo like this.”\n\n\n2022-06-08: Lasse Collin pushes back. “I haven't lost interest but my ability to care has been fairly limited mostly due to longterm mental health issues but also due to some other things. Recently I've worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we'll see. It's also good to keep in mind that this is an unpaid hobby project.”\n\n\n2022-06-10: Lasse Collin merges first commit with “Jia Tan” as author in git metadata (“Tests: Created tests for hardware functions”). Note also that there was one earlier commit on 2022-02-07 that had the full name set only to jiat75.\n\n\n2022-06-14: Lasse Collin merges only commit with “jiat75@gmail.com” as author. This could have been a temporary git misconfiguration on Jia Tan's side forgetting their fake email address.\n\n\n2022-06-14: Jugar Kumar sends pressure email. “With your current rate, I very doubt to see 5.4.0 release this year. The only progress since april has been small changes to test code. You ignore the many  patches bit rotting away on this mailing list. Right now you choke your repo. Why wait until 5.4.0 to change maintainer? Why delay what your repo needs?”\n\n\n2022-06-21: Dennis Ens sends pressure email. “I am sorry about your mental health issues, but its important to be aware of your own limits. I get that this is a hobby project for all contributors, but the community desires more. Why not pass on maintainership for XZ for C so you can give XZ for Java more attention? Or pass on XZ for Java to someone else to focus on XZ for C? Trying to maintain both means that neither are maintained well.”\n\n\n2022-06-22: Jigar Kumar sends pressure email to C patch thread. “Is there any progress on this? Jia I see you have recent commits. Why can't you commit this yourself?”\n\n\n2022-06-29: Lasse Collin replies: “As I have hinted in earlier emails, Jia Tan may have a bigger role in the project in the future. He has been helping a lot off-list and is practically a co-maintainer already. :-) I know that not much has happened in the git repository yet but things happen in small steps. In any case some change in maintainership is already in progress at least for XZ Utils.”\nJia Tan becomes maintainer\n\n\n\nAt this point Lasse seems to have started working even more closely with Jia Tan. Brian Krebs observes that many of these email addresses never appeared elsewhere on the internet, even in data breaches (nor again in xz-devel). It seems likely that they were fakes created to push Lasse to give Jia more control. It worked. Over the next few months, Jia started replying to threads on xz-devel authoritatively about the upcoming 5.4.0 release.\n\n\n2022-09-27: Jia Tan gives release summary for 5.4.0. (“The 5.4.0 release that will contain the multi threaded decoder is planned for December. The list of open issues related to 5..4.0 [sic] in general that I am tracking are...”)\n\n\n2022-10-28: Jia Tan added to the Tukaani organization on GitHub. Being an organization member does not imply any special access, but it is a necessary step before granting maintainer access.\n\n\n2022-11-30: Lasse Collin changes bug report email from his personal address to an alias that goes to him and Jia Tan, notes in README that “the project maintainers Lasse Collin and Jia Tan can be reached via xz@tukaani.org”.\n\n\n2022-12-30: Jia Tan merges a batch of commits directly into the xz repo (“CMake: Update .gitignore for CMake artifacts from in source build”). At this point we know they have commit access. Interestingly, a few commits later in the same batch is the only commit with a different full name: “Jia Cheong Tan”.\n\n\n2023-01-11: Lasse Collin tags and builds his final release, v5.4.1.\n\n\n2023-03-18: Jia Tan tags and builds their first release, v5.4.2.\n\n\n2023-03-20: Jia Tan updates Google oss-fuzz configuration to send bugs to them.\n\n\n2023-06-22: Hans Jansen sends a pair of patches, merged by Lasse Collin, that use the “GNU indirect function” feature to select a fast CRC function at startup time. The final commit is reworked by Lasse Collin and merged by Jia Tan. This change is important because it provides a hook by which the backdoor code can modify the global function tables before they are remapped read-only. While this change could be an innocent performance optimization by itself, Hans Jansen returns in 2024 to promote the backdoored xz and otherwise does not exist on the internet.\n\n\n2023-07-07: Jia Tan disables ifunc support during oss-fuzz builds, claiming ifunc is incompatible with address sanitizer. This may well be innocuous on its own, although it is also more groundwork for using ifunc later.\n\n\n2024-01-19: Jia Tan moves web site to GitHub pages, giving them control over the XZ Utils web page. Lasse Collin presumably created the DNS records for the xz.tukaani.org subdomain that points to GitHub pages. After the attack was discovered, Lasse Collin deleted this DNS record to move back to tukaani.org, which he controls.\nAttack begins\n\n\n\n2024-02-23: Jia Tan merges hidden backdoor binary code well hidden inside some binary test input files. The README already said (from long before Jia Tan showed up) “This directory contains bunch of files to test handling of .xz, .lzma (LZMA_Alone), and .lz (lzip) files in decoder implementations. Many of the files have been created by hand with a hex editor, thus there is no better \"source code\" than the files themselves.” Having these kinds of test files is very common for this kind of library. Jia Tan took advantage of this to add a few files that wouldn't be carefully reviewed.\n\n\n2024-02-24: Jia Tan tags and builds v5.6.0 and publishes an xz-5.6.0.tar.gz distribution with an extra, malicious build-to-host.m4 that adds the backdoor when building a deb/rpm package. This m4 file is not present in the source repository, but many other legitimate ones are added during package as well, so it’s not suspicious by itself. But the script has been modified from the usual copy to add the backdoor. See my xz attack shell script walkthrough post for more.\n\n\n2024-02-24: Gentoo starts seeing crashes in 5.6.0. This seems to be an actual ifunc bug, rather than a bug in the hidden backdoor, since this is the first xz with Hans Jansen’s ifunc changes, and Gentoo does not patch sshd to use libsystemd, so it doesn't have the backdoor.\n\n\n2024-02-26: Debian adds xz-utils 5.6.0-0.1 to unstable.\n\n\n2024-02-27: Jia Tan starts emailing Richard W.M. Jones to update Fedora 40 (privately confirmed by Rich Jones).\n\n\n2024-02-28: Debian adds xz-utils 5.6.0-0.2 to unstable.\n\n\n2024-02-28: Jia Tan breaks landlock detection in configure script by adding a subtle typo in the C program used to check for landlock support. The configure script tries to build and run the C program to check for landlock support, but since the C program has a syntax error, it will never build and run, and the script will always decide there is no landlock support. Lasse Collin is listed as the committer; he may have missed the subtle typo, or the author may be forged. Probably the former, since Jia Tan did not bother to forge committer on his many other changes. This patch seems to be setting up for something besides the sshd change, since landlock support is part of the xz command and not liblzma. Exactly what is unclear.\n\n\n2024-02-29: On GitHub, @teknoraver sends pull request to stop linking liblzma into libsystemd. It appears that this would have defeated the attack. Kevin Beaumont speculates that knowing this was on the way may have accelerated the attacker’s schedule. @teknoraver commented on HN that the liblzma PR was one in a series of dependency slimming changes for libsystemd; there were two mentions of it in late January.\n\n\n2024-03-04: RedHat distributions start seeing Valgrind errors in liblzma’s _get_cpuid (the entry to the backdoor). The race is on to fix this before the Linux distributions dig too deeply.\n\n\n2024-03-05: The libsystemd PR is merged to remove liblzma. Another race is on, to get liblzma backdoor'ed before the distros break the approach entirely.\n\n\n2024-03-05: Debian adds xz-utils 5.6.0-0.2 to testing.\n\n\n2024-03-05: Jia Tan commits two ifunc bug fixes. These seem to be real fixes for the actual ifunc bug. One commit links to the Gentoo bug and also typos an upstream GCC bug.\n\n\n2024-03-08: Jia Tan commits purported Valgrind fix. This is a misdirection, but an effective one.\n\n\n2024-03-09: Jia Tan commits updated backdoor files. This is the actual Valgrind fix, changing the two test files containing the attack code. “The original files were generated with random local to my machine. To better reproduce these files in the future, a constant seed was used to recreate these files.”\n\n\n2024-03-09: Jia Tan tags and build v5.6.1 and publishes xz 5.6.1 distribution, containing a new backdoor. To date I have not seen any analysis of how the old and new backdoors differ.\n\n\n2024-03-20: Lasse Collin sends LKML a patch set replacing his personal email with both himself and Jia Tan as maintainers of the xz compression code in the kernel. There is no indication that Lasse Collin was acting nefariously here, just cleaning up references to himself as sole maintainer. Of course, Jia Tan may have prompted this, and being able to send xz patches to the Linux kernel would have been a nice point of leverage for Jia Tan's future work. We're not at trusting trust levels yet, but it would be one step closer.\n\n\n2024-03-25: Hans Jansen is back (!), filing a Debian bug to get xz-utils updated to 5.6.1. Like in the 2022 pressure campaign, more name###@mailhost addresses that don’t otherwise exist on the internet show up to advocate for it.\n\n\n2024-03-27: Debian updates to 5.6.1.\n\n\n2024-03-28: Jia Tan files an Ubuntu bug to get xz-utils updated to 5.6.1 from Debian.\nAttack detected\n\n\n\n2024-03-28: Andres Freund discovers bug, privately notifies Debian and distros@openwall. RedHat assigns CVE-2024-3094.\n\n\n2024-03-28: Debian rolls back 5.6.1, introducing 5.6.1+really5.4.5-1.\n\n\n2024-03-28: Arch Linux changes 5.6.1 to build from Git.\n\n\n2024-03-29: Andres Freund posts backdoor warning to public oss-security@openwall list, saying he found it “over the last weeks”.\n\n\n2024-03-29: RedHat announces that the backdoored xz shipped in Fedora Rawhide and Fedora Linux 40 beta.\n\n\n2024-03-30: Debian shuts down builds to rebuild their build machines using Debian stable (in case the malware xz escaped their sandbox?).\n\n\n2024-03-30: Haiku OS moves to GitHub source repo snapshots.\nFurther Reading\n\n\nEvan Boehs, Everything I know about the XZ backdoor (2024-03-29).\n\nFilippo Valsorda, Bluesky re backdoor operation (2024-03-30).\n\nMichał Zalewski, Techies vs spies: the xz backdoor debate (2024-03-30).\n\nMichał Zalewski, OSS backdoors: the folly of the easy fix (2024-03-31).\n\nConnor Tumbleson, Watching xz unfold from afar (2024-03-31).\n\nnugxperience, Twitter re awk and rc4 (2024-03-29)\n\nbirchb0y, Twitter re time of day of commit vs level of evil (2024-03-29)\n\nDan Feidt, 'xz utils' Software Backdoor Uncovered in Years-Long Hacking Plot (2024-03-30)\n\nsmx-smz, [WIP] XZ Backdoor Analysis and symbol mapping\n\nDan Goodin, What we know about the xz Utils backdoor that almost infected the world (2024-04-01) \n\nAkamai Security Intelligence Group, XZ Utils Backdoor — Everything You Need to Know, and What You Can Do (2024-04-01)\n\nKevin Beaumont, Inside the failed attempt to backdoor SSH globally — that got caught by chance (2024-03-31)\n\namlweems, xzbot: notes, honeypot, and exploit demo for the xz backdoor (2024-04-01)\n\nRhea Karty and Simon Henniger, XZ Backdoor: Times, damned times, and scams (2024-03-30)\n\nAndy Greenberg and Matt Burgess, The Mystery of ‘Jia Tan,’ the XZ Backdoor Mastermind (2024-04-03)\n\nRisky Business #743 -- A chat about the xz backdoor with the guy who found it (2024-04-03)\n\n      ","length":15502,"excerpt":"Posted on Monday, April 1, 2024.Updated Wednesday, April 3, 2024.","byline":null,"dir":null,"siteName":null,"lang":null},"finalizedMeta":{"title":"research!rsc: Timeline of the xz open source attack","description":"Posted on Monday, April 1, 2024.Updated Wednesday, April 3, 2024.","author":false,"creator":"","publisher":false,"date":"2024-05-16T17:33:40.205Z","topics":[]},"jsonLd":{"@type":false,"headline":false,"description":false,"image":[],"mainEntityOfPage":{"@type":false,"@id":false},"datePublished":false,"dateModified":false,"isAccessibleForFree":false,"isPartOf":{"@type":[],"name":false,"productID":false},"discussionUrl":false,"license":false,"author":{"@type":false,"name":false,"description":false,"sameAs":false,"image":{"@type":false,"url":false},"givenName":false,"familyName":false,"alternateName":false,"publishingPrinciples":false},"publisher":{"@type":false,"name":false,"description":false,"sameAs":false,"logo":{"@type":false,"url":false},"publishingPrinciples":false},"editor":{"@type":false,"name":false,"description":false,"sameAs":false,"image":{"@type":false,"url":false},"givenName":false,"familyName":false,"alternateName":false,"publishingPrinciples":false}},"twitterObj":false,"status":200,"metadata":{"author":false,"title":"research!rsc: Timeline of the xz open source attack","description":false,"canonical":"https://research.swtch.com/xz-timeline","keywords":[],"image":false,"firstParagraph":"\nOver a period of over two years, an attacker using the name “Jia Tan”\nworked as a diligent, effective contributor to the xz compression library,\neventually being granted commit access and maintainership.\nUsing that access, they installed a very subtle, carefully hidden backdoor into liblzma,\na part of xz that also happens to be a dependency of OpenSSH sshd\non Debian, Ubuntu, and Fedora, and other systemd-based Linux systems that patched sshd to link libsystemd.\n(Note that this does not include systems like Arch Linux, Gentoo, and NixOS, which do not patch sshd.)\nThat backdoor watches for the attacker sending hidden commands at the start of an SSH session,\ngiving the attacker the ability to run an arbitrary command on the target system without logging in:\nunauthenticated, targeted remote code execution.\n\n"},"dublinCore":{},"opengraph":{"title":false,"description":false,"url":false,"site_name":false,"locale":false,"type":false,"typeObject":{"published_time":false,"modified_time":false,"author":false,"publisher":false,"section":false,"tag":[]},"image":false},"twitter":{"site":false,"description":false,"card":false,"creator":false,"title":false,"image":false},"archivedData":{"link":"https://web.archive.org/web/20240514231749/https://research.swtch.com/xz-timeline","wayback":"https://web.archive.org/web/20240514231749/https://research.swtch.com/xz-timeline"}}}